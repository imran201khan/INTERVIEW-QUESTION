create database DD;
use DD;
create table Salesmans
(ID INT NOT NULL ,
NAME VARCHAR(30) NOT NULL,
CITY VARCHAR(30) NOT NULL,
COMMISSION INT NOT NULL,
PRIMARY KEY(ID)
);
CREATE TABLE Customers
(ID INT NOT NULL,
NAME VARCHAR(30) NOT NULL,
CITY VARCHAR(30),
GRADE INT NOT NULL,
SALESMAN_ID INT NOT NULL,
PRIMARY KEY(ID),
FOREIGN KEY (SALESMAN_ID) REFERENCES Salesmans(ID)
);
CREATE TABLE Orders
(ORDER_NO INT NOT NULL,
PURCHASE_AMOUNT INT NOT NULL,
ORDER_DATE DATE,
CUSTOMERS_ID INT NOT NULL, 
SALESMAN_ID INT NOT NULL,
PRIMARY KEY(ORDER_NO),
FOREIGN KEY (CUSTOMERS_ID) REFERENCES Customers(ID),
FOREIGN KEY (SALESMAN_ID) REFERENCES Salesmans(ID)
);

-- INSERT VALUES IN SALESMAN TABLE

INSERT INTO Salesmans (ID,NAME,CITY,COMMISSION)
values(101,"JAMSE","NEW YORK",150),(102,"NAIL","PARIS",130),(103,"ALEX","LONDON",110),
(104,"MACOY","PARIS",140),(105,"PAUL","ROME",130),(106,"LAUSON","SANJOSE",120);
SELECT * FROM Salesmans;

-- INSERT VALUES IN CUSTOMERS 
INSERT INTO Customers (ID,NAME,CITY,GRADE,SALESMAN_ID)
VALUES(1,"NICK","NEW YORK",100,101),(2,"BRAD","NEW YORK",200,102),(3,"GRAHM","CALIFORNIA",200,103),
(4,"JULIE","LONDON",300,104),(5,"FABIAN","PARIS",300,105),(6,"GEOFF","BERLIN",300,106),
(7,"JOS","MOSCOW",100,101),(8,"GUZAN","LONDON",200,102);
SELECT * FROM Customers;

-- INSERT VALUES IN ORDERS
INSERT INTO Orders(ORDER_NO,PURCHASE_AMOUNT,ORDER_DATE,CUSTOMERS_ID,SALESMAN_ID)
VALUES (7001,250,"2012-10-05",5,105),(7009,270,"2012-12-10",1,101),(7002,60,"2012-10-05",5,105),
(7004,102,"2012-08-17",2,102),(7007,950,"2012-09-10",3,103),(7005,2450,"2012-07-27",8,102),
(7008,5700,"2012-09-10",4,104),(7003,1980,"2012-10-10",7,101),(7006,75,"2012-10-10",6,106),
(7010,3045,"2012-06-27",1,101);
SELECT * FROM Orders;
SELECT O.ORDER_NO,C.NAME,O.ORDER_DATE,C.ID,S.ID FROM 
Customers C INNER JOIN Orders O On O.CUSTOMERS_ID = C.ID  INNER JOIN Salesmans S ON C.SALESMAN_ID=S.ID
WHERE S.CITY<>C.CITY
ORDER BY O.ORDER_NO